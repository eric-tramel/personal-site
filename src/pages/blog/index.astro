---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog", ({ data }) => !data.draft);
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<BaseLayout title="Blog">
  <div class="blog-index">
    <h1>Blog</h1>
    <ul class="post-list">
      {posts.map((post) => {
        const formattedDate = post.data.date.toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
        }).replace(',', '');
        return (
          <li class="post-item">
            <time
              datetime={post.data.date.toISOString()}
              class="post-date"
            >
              {formattedDate}
            </time>
            <a
              href={`/blog/${post.id}/`}
              class="post-link"
            >
              {post.data.title}
            </a>
          </li>
        );
      })}
    </ul>
  </div>
</BaseLayout>

<style>
  .blog-index {
    max-width: 810px;
    margin: 0 auto;
  }

  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .post-item {
    display: flex;
    align-items: baseline;
    gap: 1rem;
    margin-bottom: 0.75rem;
  }

  .post-date {
    font-size: 14px;
    color: #4c566a;
    flex-shrink: 0;
    white-space: nowrap;
    width: 7.5rem;
    min-width: 7.5rem;
    font-weight: 300;
    font-variant-numeric: tabular-nums;
  }

  .post-link {
    color: #1a365d;
    font-weight: 500;
    text-decoration: underline;
  }

  .post-link:hover {
    color: #2c5282;
  }
</style>
